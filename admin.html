<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title data-lang="title">Админ | HusmaFit</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <style>
    body { font-family: 'Poppins', sans-serif; background: #111827; color: white; }
    .table { @apply w-full text-left border-collapse; }
    .th { @apply px-4 py-3 bg-gray-800 border-b border-gray-700 font-bold text-xs sm:text-sm; }
    .td { @apply px-4 py-3 border-b border-gray-700 text-xs sm:text-sm; }
    .badge { @apply inline-block px-2 py-1 rounded-full text-xs font-bold; }
    .modal { @apply fixed inset-0 bg-black/80 flex items-center justify-center z-50; }
    .modal-content { @apply bg-gray-800 p-6 rounded-xl max-w-xs w-full mx-4 shadow-2xl; }
    .logout-btn { @apply bg-red-600 text-white px-3 py-2 rounded-lg font-bold hover:bg-red-700 transition flex items-center gap-1.5 text-xs; }
    .nav-link { @apply relative transition-all duration-300 hover:text-red-500 text-xs sm:text-sm; }
    .nav-link::after { content: ''; @apply absolute bottom-0 left-0 w-0 h-0.5 bg-red-600 transition-all duration-300; }
    .nav-link:hover::after { @apply w-full; }
    .status-btn { @apply px-2.5 py-1.5 rounded-full text-xs font-bold transition-all duration-200 cursor-pointer flex items-center gap-1; }
    .status-pending { @apply bg-orange-600 hover:bg-orange-700; }
    .status-paid { @apply bg-green-600; }
    .action-icon { @apply text-base transition-all duration-200; }
    .delete-btn { @apply text-red-400 hover:text-red-600 transition-all duration-200; }
    .search-input { @apply w-full px-3 py-2 bg-gray-700 rounded-lg text-white focus:ring-2 focus:ring-red-600 outline-none text-xs sm:text-sm; }
    .clear-btn { @apply bg-red-600 text-white px-3 py-2 rounded-lg font-bold hover:bg-red-700 transition flex items-center gap-1.5 text-xs; }
    .mobile-menu { @apply bg-gray-800/98 backdrop-blur-md border-t border-gray-700 py-4 px-4; }
    .mobile-nav { @apply flex flex-col gap-2 text-left text-xs; }
  </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">

  <div id="login-modal" class="modal flex flex-col justify-center items-center">
    <div class="modal-content flex flex-col justify-center items-center text-center h-[100vh]">
      <i class="fas fa-shield-alt text-4xl text-red-600 mb-2"></i>
      <h2 class="text-xl font-bold" data-lang="login-title">Админ панель</h2>
      <p class="text-xs text-gray-400 mt-1" data-lang="login-subtitle">Введите пароль</p>
      <input type="password" id="password" placeholder="Пароль" class="w-full px-3 py-2.5 bg-gray-700 rounded-lg text-white mb-3 text-sm focus:ring-2 focus:ring-red-600 outline-none" data-lang-placeholder="password-placeholder" />
      <button onclick="login()" class="w-full bg-green-600 text-white py-2.5 rounded-lg font-bold hover:bg-green-700 transition text-sm" data-lang="btn-login">
        Войти
      </button>
      <button onclick="logoutToHome()" class="w-full logout-btn mt-2">
        <i class="fas fa-home"></i> <span data-lang="btn-back">На главную</span>
      </button>
    </div>
  </div>

  <!-- ADMIN PANEL -->
  <div id="admin-panel" class="hidden">

  <header class="bg-gray-800/95 backdrop-blur-sm py-3 px-4 md:px-8 shadow-xl fixed top-0 left-0 w-full z-50 border-b border-gray-700">
    <div class="container mx-auto flex justify-between items-center">
      <!-- Logo -->
      <div class="flex items-center gap-2">
        <img src="./446215302_1156955372010908_2017285007514614506_n.jpg" alt="HusmaFit Логотип" class="w-11 h-11 rounded-full object-cover shadow-md hover:scale-110 transition" loading="lazy" />
        <h1 class="text-xl md:text-2xl font-extrabold">Husma<span class="text-red-600">Fit</span></h1>
      </div>

      <!-- Desktop Nav -->
      <nav class="hidden md:flex items-center gap-5 text-sm">
        <a href="index.html" class="nav-link font-semibold" data-lang="nav-home">Главная</a>
        <a href="онас.html" class="nav-link font-semibold" data-lang="nav-about">О нас</a>
        <a href="услуги.html" class="nav-link font-semibold" data-lang="nav-services">Услуги</a>
        <a href="jadval.html" class="nav-link font-semibold" data-lang="nav-schedule">Расписание</a>
        <a href="trainers.html" class="nav-link font-semibold" data-lang="nav-trainers">Тренеры</a>
        <a href="kontakt.html" class="nav-link font-semibold" data-lang="nav-contact">Контакты</a>
        <a href="user-register.html" class="bg-red-600 text-white px-4 py-2 rounded-full font-bold hover:bg-red-700" data-lang="nav-register">Регистрация</a>
        <a href="admin.html" class="bg-yellow-600 text-white px-4 py-2 rounded-full font-bold block text-center text-red-500" data-lang="nav-admin">Админ-панель</a>
        <!-- Language Button -->
        <button id="lang-toggle" class="bg-gray-700 text-white px-3 py-2 rounded-full text-xs font-bold hover:bg-gray-600 transition flex items-center gap-1 ml-2">
          <i class="fas fa-globe"></i> <span id="lang-text">EN</span>
        </button>
      </nav>


      <!-- Social (Desktop) -->
      <div class="hidden md:flex gap-3">
        <a href="tel:+998770009090" class="text-gray-400 hover:text-blue-500 flex items-center gap-2"><i class="fa-solid fa-phone"></i></a>
        <a href="https://www.instagram.com/husma.fit/#" class="text-gray-400 hover:text-pink-500"><i class="fab fa-instagram"></i></a>
        <a href="https://t.me/Husma_Hotel_Spa" class="text-gray-400 hover:text-blue-500 flex items-center gap-2"><i class="fab fa-telegram-plane"></i></a>
      </div>

      <!-- Mobile Button -->
      <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="md:hidden">
        <i class="fas fa-bars text-lg"></i>
      </button>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden md:hidden bg-gray-800/98 backdrop-blur-md border-t border-gray-700 py-4 px-6 mobile-menu">
      <nav class="flex flex-col gap-3 text-left">
        <a href="index.html" class="nav-link font-semibold" data-lang="nav-home">Главная</a>
        <a href="онас.html" class="nav-link font-semibold" data-lang="nav-about">О нас</a>
        <a href="услуги.html" class="nav-link font-semibold" data-lang="nav-services">Услуги</a>
        <a href="jadval.html" class="nav-link font-semibold" data-lang="nav-schedule">Расписание</a>
        <a href="trainers.html" class="nav-link font-semibold" data-lang="nav-trainers">Тренеры</a>
        <a href="kontakt.html" class="nav-link font-semibold" data-lang="nav-contact">Контакты</a>
        <a href="user-register.html" class="bg-red-600 text-white px-4 py-2 rounded-full font-bold hover:bg-red-700" data-lang="nav-register">Регистрация</a>
        <a href="admin.html" class="bg-yellow-600 text-white px-4 py-2 rounded-full font-bold block text-center text-red-500" data-lang="nav-admin">Админ-панель</a>
                <!-- Language Button -->
        <button id="lang-toggle1" class="bg-gray-700 text-white px-3 py-2 rounded-full text-xs font-bold hover:bg-gray-600 transition flex items-center gap-1 ml-2">
          <i class="fas fa-globe"></i> <span id="lang-text">EN</span>
        </button>
      </nav>
      <div class="flex gap-4 mt-4 justify-center">
        <a href="tel:+998770009090" class="text-gray-400 hover:text-blue-500 flex items-center gap-2"><i class="fa-solid fa-phone"></i></a>
        <a href="https://www.instagram.com/husma.fit/#" class="text-gray-400 hover:text-pink-500"><i class="fab fa-instagram"></i></a>
        <a href="https://t.me/Husma_Hotel_Spa" class="text-gray-400 hover:text-blue-500 flex items-center gap-2"><i class="fab fa-telegram-plane"></i></a>
      </div>
    </div>
  </header>

    <!-- Content -->
    <section class="pt-20 pb-8 px-3">
      <div class="container mx-auto">
        <div class="bg-gray-800 rounded-xl shadow-xl p-4">
          <h2 class="text-xl font-bold mb-4 flex items-center gap-1.5">
            <i class="fas fa-users text-green-500 text-lg"></i> <span data-lang="section-title">Зарегистрированные</span>
          </h2>

          <!-- Search + Clear -->
          <div class="flex flex-col sm:flex-row gap-2 mb-3">
            <input type="text" id="search" placeholder="Поиск..." class="search-input" data-lang-placeholder="search-placeholder">
            <button onclick="clearList()" class="clear-btn w-full sm:w-auto">
              <i class="fas fa-trash"></i> <span data-lang="btn-clear">Очистить</span>
            </button>
          </div>

          <div class="overflow-x-auto">
            <table class="table">
              <thead>
                <tr>
                  <th class="th" data-lang="th-number">№</th>
                  <th class="th" data-lang="th-name">Имя</th>
                  <th class="th" data-lang="th-phone">Телефон</th>
                  <th class="th" data-lang="th-sport">Спорт</th>
                  <th class="th" data-lang="th-plan">Абонемент</th>
                  <th class="th" data-lang="th-date">Дата</th>
                  <th class="th" data-lang="th-status">Статус</th>
                  <th class="th" data-lang="th-action">Действие</th>
                </tr>
              </thead>
              <tbody id="registrations-table"></tbody>
            </table>
          </div>

          <div id="empty" class="text-center py-8 text-gray-500 hidden">
            <i class="fas fa-inbox text-3xl mb-2"></i>
            <p class="text-xs" data-lang="empty-message">Пока никто не зарегистрировался</p>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Translation + Logic -->
  <script>
    const CORRECT_PASSWORD = "husmafit2025";

    const translations = {
      ru: {
        "title": "Админ | HusmaFit", "login-title": "Админ панель", "login-subtitle": "Введите пароль", "password-placeholder": "Пароль",
        "btn-login": "Войти", "btn-back": "На главную", "nav-home": "Главная", "nav-about": "О нас", "nav-services": "Услуги",
        "nav-schedule": "Расписание", "nav-trainers": "Тренеры", "nav-contact": "Контакты", "nav-register": "Регистрация",
        "nav-admin": "Админ", "section-title": "Зарегистрированные", "search-placeholder": "Поиск по имени или телефону...",
        "th-number": "№", "th-name": "Имя", "th-phone": "Телефон", "th-sport": "Спорт", "th-plan": "Абонемент",
        "th-date": "Дата", "th-status": "Статус", "th-action": "Действие", "empty-message": "Пока никто не зарегистрировался",
        "btn-logout": "Выйти", "status-pending": "Ожидает", "status-paid": "Оплачено", "alert-wrong-pass": "Неверный пароль!",
        "confirm-clear": "Вы уверены, что хотите удалить всех?", "alert-cleared": "Список очищен!", "btn-clear": "Очистить",
        "confirm-delete": "Удалить этого пользователя?", "alert-deleted": "Удалено!", "lang-text": "EN"
      },
      en: {
        "title": "Admin | HusmaFit", "login-title": "Admin Panel", "login-subtitle": "Enter password", "password-placeholder": "Password",
        "btn-login": "Login", "btn-back": "Back to Home", "nav-home": "Home", "nav-about": "About", "nav-services": "Services",
        "nav-schedule": "Schedule", "nav-trainers": "Trainers", "nav-contact": "Contact", "nav-register": "Register",
        "nav-admin": "Admin", "section-title": "Registered", "search-placeholder": "Search by name or phone...",
        "th-number": "No.", "th-name": "Name", "th-phone": "Phone", "th-sport": "Sport", "th-plan": "Plan",
        "th-date": "Date", "th-status": "Status", "th-action": "Action", "empty-message": "No registrations yet",
        "btn-logout": "Logout", "status-pending": "Pending", "status-paid": "Paid", "alert-wrong-pass": "Wrong password!",
        "confirm-clear": "Delete all users?", "alert-cleared": "List cleared!", "btn-clear": "Clear All",
        "confirm-delete": "Delete this user?", "alert-deleted": "Deleted!", "lang-text": "RU"
      }
    };

    const prices = {
      gym: { day: 80000, month: 1600000, year: 9240000 },
      pool: { day: 140000, month: 2500000, year: 14000000 },
      massage: { day: 250000, month: 4500000, year: 25000000 },
      sauna: { day: 200000, month: 3600000, year: 20000000 }
    };

    const sportNames = {
      ru: { gym: "Фитнес-зал", pool: "Бассейн", massage: "Массаж", sauna: "Сауна" },
      en: { gym: "Gym", pool: "Pool", massage: "Massage", sauna: "Sauna" }
    };

    const periodNames = {
      ru: { day: "1 день", month: "1 месяц", year: "1 год" },
      en: { day: "1 Day", month: "1 Month", year: "1 Year" }
    };

    let currentLang = localStorage.getItem('lang') || 'ru';

    function formatPrice(price) {
      return parseInt(price).toLocaleString() + ' сум';
    }

    function getPlanText(sport, price) {
      const p = parseInt(price);
      let period = 'day';
      const sportPrices = prices[sport];
      if (sportPrices) {
        if (p === sportPrices.month) period = 'month';
        if (p === sportPrices.year) period = 'year';
      }
      const periodName = periodNames[currentLang][period] || period;
      return `${periodName} – ${formatPrice(price)}`;
    }

    function toggleLanguage() {
      currentLang = currentLang === 'ru' ? 'en' : 'ru';
      localStorage.setItem('lang', currentLang);
      document.documentElement.lang = currentLang;
      updateTexts();
      document.getElementById('lang-text').textContent = translations[currentLang]['lang-text'];
      const mobile = document.getElementById('lang-text-mobile');
      if (mobile) mobile.textContent = translations[currentLang]['lang-text'];
      loadRegistrations();
    }

    function updateTexts() {
      const t = translations[currentLang];
      document.querySelector('title').textContent = t["title"];
      document.querySelectorAll('[data-lang]').forEach(el => {
        const key = el.getAttribute('data-lang');
        if (t[key]) el.innerHTML = t[key];
      });
      document.querySelectorAll('[data-lang-placeholder]').forEach(el => {
        const key = el.getAttribute('data-lang-placeholder');
        if (t[key]) el.placeholder = t[key];
      });
    }

    function login() {
      const input = document.getElementById('password').value.trim();
      const modal = document.getElementById('login-modal');
      if (input === CORRECT_PASSWORD) {
        modal.classList.add('hidden');
        modal.classList.remove('flex');
        document.getElementById('admin-panel').classList.remove('hidden');
        loadRegistrations();
      } else {
        alert(translations[currentLang]["alert-wrong-pass"]);
      }
    }

    function logout() {
      document.getElementById('admin-panel').classList.add('hidden');
      const modal = document.getElementById('login-modal');
      modal.classList.remove('hidden');
      modal.classList.add('flex');
      document.getElementById('password').value = '';
    }

    function logoutToHome() {
      window.location.href = "index.html";
    }

    function markAsPaid(index) {
      let regs = JSON.parse(localStorage.getItem('registrations') || '[]');
      regs[index].paid = true;
      regs[index].paidDate = new Date().toLocaleString(currentLang === 'ru' ? 'ru-RU' : 'en-US');
      localStorage.setItem('registrations', JSON.stringify(regs));
      loadRegistrations();
    }

    function deleteUser(index) {
      const t = translations[currentLang];
      if (confirm(t["confirm-delete"])) {
        let regs = JSON.parse(localStorage.getItem('registrations') || '[]');
        regs.splice(index, 1);
        localStorage.setItem('registrations', JSON.stringify(regs));
        loadRegistrations();
        alert(t["alert-deleted"]);
      }
    }

    function loadRegistrations() {
      const registrations = JSON.parse(localStorage.getItem('registrations') || '[]');
      const table = document.getElementById('registrations-table');
      const empty = document.getElementById('empty');
      const search = document.getElementById('search').value.toLowerCase();
      const t = translations[currentLang];

      const filtered = registrations.filter(r =>
        r.name.toLowerCase().includes(search) || r.phone.includes(search)
      );

      if (filtered.length === 0) {
        empty.classList.remove('hidden');
        table.innerHTML = '';
        return;
      }

      empty.classList.add('hidden');
      table.innerHTML = '';

      filtered.forEach((reg, i) => {
        const idx = registrations.indexOf(reg);
        const sportName = sportNames[currentLang][reg.sport] || reg.sport;
        const planText = getPlanText(reg.sport, reg.plan);

        const statusHTML = reg.paid
          ? `<div class="status-btn status-paid"><i class="fas fa-check action-icon"></i> ${t["status-paid"]}</div>`
          : `<div class="status-btn status-pending" onclick="markAsPaid(${idx})"><i class="fas fa-times action-icon"></i> ${t["status-pending"]}</div>`;

        const row = document.createElement('tr');
        row.className = 'hover:bg-gray-700 transition';
        row.innerHTML = `
          <td class="td">${idx + 1}</td>
          <td class="td font-medium">${reg.name}</td>
          <td class="td"><a href="tel:${reg.phone}" class="text-green-400 hover:underline text-xs">${reg.phone}</a></td>
          <td class="td">${sportName}</td>
          <td class="td"><span class="badge bg-indigo-600">${planText}</span></td>
          <td class="td text-gray-400">${reg.date}</td>
          <td class="td">${statusHTML}</td>
          <td class="td">
            <button onclick="deleteUser(${idx})" class="delete-btn" title="${t["confirm-delete"]}">
              <i class="fas fa-trash-alt"></i>
            </button>
          </td>
        `;
        table.appendChild(row);
      });
    }

    function clearList() {
      const t = translations[currentLang];
      if (confirm(t["confirm-clear"])) {
        localStorage.removeItem('registrations');
        loadRegistrations();
        alert(t["alert-cleared"]);
      }
    }

    document.getElementById('search').addEventListener('input', loadRegistrations);

    setInterval(() => {
      if (!document.getElementById('admin-panel').classList.contains('hidden')) {
        loadRegistrations();
      }
    }, 3000);

    document.getElementById('password').addEventListener('keypress', e => {
      if (e.key === 'Enter') login();
    });

    document.addEventListener('DOMContentLoaded', () => {
      const lt = document.getElementById('lang-toggle');
      const ltm = document.getElementById('lang-toggle-mobile');
      if (lt) lt.addEventListener('click', toggleLanguage);
      if (ltm) ltm.addEventListener('click', toggleLanguage);

      document.documentElement.lang = currentLang;
      updateTexts();
      document.getElementById('lang-text').textContent = translations[currentLang]['lang-text'];
      const mt = document.getElementById('lang-text-mobile');
      if (mt) mt.textContent = translations[currentLang]['lang-text'];
    });
  </script>
</body>
</html>
